<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<link th:href="@{/stylesheet.css?version=60}" rel="stylesheet"/>
<script type="text/javascript" th:src="@{/script.js?Num=12}"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<head>
    <meta charset="UTF-8">
    <title>Main Page</title>
</head>

<header>
    <!-- these links function the same as selecting a type at the 'typeSelect' element -->
    <a th:href="@{/mainPage(type='movie')}">
        <button class="button1">Movie</button>
    </a>
    <a th:href="@{/mainPage(type='tvShow')}">
        <button class="button1">TvShow</button>
    </a>
    <a th:href="@{/mainPage(type='book')}">
        <button class="button1">Book</button>
    </a>
    <a th:href="@{/mainPage(type='manga')}">
        <button class="button1">Manga</button>
    </a>
    <a th:href="@{/mainPage(type='baking')}">
        <button class="button1">Baking</button>
    </a>
    <a th:href="@{/mainPage(type='cooking')}">
        <button class="button1">Cooking</button>
    </a>
    <a th:href="@{/mainPage(type='game')}">
        <button class="button1">Game</button>
    </a>

    <a th:href="@{/wishlist}">
        <button id="wishListLink" class="button1">WishList</button>
    </a>
</header>
<body>
<!-- mediaTable gets generated by javascript -->
<div id="mediaTableDiv">
</div> <!-- #mediaTableDiv -->
<div id="sideDiv">
    <!-- addDiv is set to display:none until 'addMediaBtn' is clicked.
         'th:object="${String}' is syntax from thymeleaf, it fills the select element with text sent by the backend java
     -->
    <div id="addDiv">
        <form action="#" th:action="@{/mainPage/addMedia}" th:object="${media}" method="post" id="myForm">
            <label>Name:</label>
            <input id="nameInput" th:field="*{name}">
            <label>Type:</label>
            <select name="typeSelect2" id="typeSelect2" th:field="*{type}" onchange="">
                <option value="movie">movie</option>
                <option value="game">game</option>
                <option value="music">music</option>
                <option value="tvShow">tvshow</option>
                <option value="baking">baking</option>
                <option value="cooking">cooking</option>
                <option value="manga">manga</option>
                <option value="book">book</option>
            </select>
            <label>Link:</label>
            <input id="linkInput" th:field="*{link}">
            <label>ViewedDate:</label>
            <input id="dateInput" th:field="*{stringDate}">
            <label>HaveTried:</label>
            <input id="haveTriedInput" th:field="*{haveTried}">
            <label>Rating:</label>
            <input id="ratingInput" th:field="*{rating}">

            <!-- this button submits the form which sends a Post request to the backend that adds a Media to the Media list -->
           <button id="submitMediaBtn" class="button1">Submit Media</button>
       </form>
   </div> <!-- #addDiv -->

    <!-- changes what Media will be shown, the media field 'haveSeen' determines if it gets shown  -->
    <select name="haveSeen" id="haveSeenSelect" class="select1" onchange="haveSeenSelectFunc()">
        <option value="all">show all media</option>
        <option value="true">show have seen media</option>
        <option value="false">show have not seen media</option>
    </select>

    <!-- only shows media which has the same type as the one selected -->
    <select name="type" id="typeSelect" class="select1" onchange="typeSelectFunc()">
        <option value="all">all</option>
        <option value="movie">movie</option>
        <option value="game">game</option>
        <option value="music">music</option>
        <option value="tvShow">tvshow</option>
        <option value="baking">baking</option>
        <option value="cooking">cooking</option>
        <option value="manga">manga</option>
        <option value="book">book</option>
    </select>

    <button id="addMediaBtn" class="button1">Add media</button>
    <button id="removeMediaBtn" class="button1">Remove selected media</button>
    <button id="haveTriedBtn" class="button1">Set Media as "haveTried"</button>

    <button id="changeViewBtn" class="button1"> change view</button>
    <button id="wishlistBtn" class="button1"> Add to wishlist</button>
</div> <!-- #sideDiv -->

<script th:inline="javascript">
      var mediaListJs = /*[[${mediaList}]]*/; //this contains the media list which gets sent from the back end
      var typeJs = /*[[${type}]]*/; //this is the type of media which gets sent as a url paramter
      var selectedRowText = " ";

      document.onload = init(mediaListJs); //initializes the javascript code

      //prevents crashing
      if(typeJs != null) {
        document.onload = document.getElementById("typeSelect").value = typeJs;
        document.onload = localStorage.setItem("typeSelect",typeJs); //remembers the type selected in local storage
      }

      document.onload = generateCorrectMediaList(); //generates the list of media, goes in 'mediaTable'

      //when a button is pushed it sends the user to a url which will be mapped to a method in the backend java
      //these 3 buttons are for removing media, chaning haveTried attribute, adding media to wishlist

      document.getElementById("removeMediaBtn").addEventListener("click", function() {
        selectedRowText = getSelectedRowText();
            window.location.replace("/mainPage/removeMedia?mediaName=" +selectedRowText);
      });
      document.getElementById("haveTriedBtn").addEventListener("click", function() {
        selectedRowText = getSelectedRowText();
            window.location.replace("/mainPage/haveTried?mediaName=" +selectedRowText);
      });
      document.getElementById("wishlistBtn").addEventListener("click", function() {
        selectedRowText = getSelectedRowText();
            window.location.replace("/mainPage/addToWishlist?mediaName=" +selectedRowText);
      });
</script>
</body>
</html>

